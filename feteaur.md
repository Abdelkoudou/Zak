# Features

This document outlines all the key features of the MCQ Study App (backend + frontend) aligned with the French-medical-education structure and the additional student-centric requirements you provided.

---

## 1. User & Authentication

- User registration: students register with email, username, password, study year, speciality.  
- Login with JWT access tokens.  
- “Get current user” endpoint to retrieve authenticated user profile.  
- Change password: users can change their own password.  
- Device session management: each user can register up to **2 devices** (e.g., phone + computer/tablet).  
  - Register Device endpoint.  
  - List active device sessions.  
  - Deactivate a device session.

---

## 2. Roles & Permissions

- Four built-in roles:  
  - Owner: full system access; cannot be modified by others.  
  - Admin: manage users, manage activation keys, view dashboard stats, manage questions.  
  - Manager: content management (questions import/create/update/delete), user payment status updates; cannot generate activation keys or change roles.  
  - Student: standard user role – access to questions (if paid), manage own profile and devices.  
- Role-based access control (RBAC) enforced on all endpoints.  
- Owner protection: owner cannot be edited or deleted by anyone else.  
- Payment-based access: Students must have `is_paid = true` to access question endpoints.

---

## 3. Subscription & Activation Keys

- Activation key system: single-use keys generated by Admin/Owner.  
- Students activate their account via providing an activation key: sets `is_paid = true`, sets expiry date.  
- Payment methods supported:  
  - Physical subscription cards (distributed offline).  
  - Digital payment (e.g., Baridi Mob) where student sends receipt via email / app.  
- Device limit enforced in relation to subscription (max 2 devices per paid user).

---

## 4. Medical MCQ Question & Structure Management

### 4.1 Curriculum Structure (French medical education)

- Year of study: 1st, 2nd, 3rd year.  
- 1ère Année (Year 1) modules (annual & semestrial):  
  - Annual modules: Anatomie (EMD1/EMD2/Rattrapage), Biochimie, Biophysique, Biostatistique/Informatique, Chimie, Cytologie.  
  - Semestrial modules: Embryologie, Histologie, Physiologie, S.S.H (EMD/Rattrapage).  
- 2ème Année (Year 2) units (UEI) & standalone modules:  
  - UEI: Appareil Cardio-vasculaire et Respiratoire; Appareil Digestif; Appareil Urinaire; Appareil Endocrinien & de la Reproduction; Appareil Nerveux et Organes des Sens.  
  - Standalone modules: Génétique, Immunologie.  
- 3ème Année (Year 3) units & standalone modules: (as per your list)  
  - Units: Appareil Cardio-vasculaire et Respiratoire; Psychologie Médicale & Sémiologie Générale; Appareil Neurologique; Appareil Endocrinien; Appareil Urinaire; Appareil Digestif.  
  - Standalone: Anatomie pathologique, Immunologie, Pharmacologie, Microbiologie, Parasitologie.

### 4.2 Question & Answer Features

- CRUD operations for questions and answers (Create, Read, Update, Delete) for Manager/Admin.  
- Import questions via JSON file for bulk question upload.  
- Questions contain metadata:  
  - `year`: exam year (e.g., 2024)  
  - `study_year`: 1/2/3  
  - `module` or `unite` depending on year  
  - `speciality` (e.g., Médecine)  
  - `cours` (list of course names)  
  - `exam_type` (EMD, EMD1, EMD2, Rattrapage)  
  - `number`: question number  
  - `question_text`  
  - Optional `question_image`  
  - `answers`: list of options with `answer_text`, optional `answer_image`, `is_correct`, `option_label`.  
- Filtering / retrieval for Students:  
  - Endpoint to list questions with filters: skip, limit, year, study_year, module, unite, speciality, cours, exam_type.  
  - Retrieve single question by ID.  
- Additional endpoints to support UI: list of modules, units, courses, years, study years.  
- Structure endpoint (public, no authentication) to expose full curriculum structure (years, modules, units, exam types).

---

## 5. Student-Centric Additional Features (Arabic/Algerian market focus)

These features go beyond the typical backend and may involve UI/app side, but must be supported by the backend or data model where relevant:

- **Save Questions**: students can mark/save questions (e.g., ones they got wrong) for later review.  
  - Backend support: `saved_questions` table linking user ↔ question.  
- **Results / Statistics Tracking**: for each attempt/test by student, track results.  
  - Model to record test session: user_id, date, questions attempted, correct count, score.  
  - Analytics: provide per-user stats over time.  
- **Lesson Frequency Statistics**: after a student chooses a module and selects number of years (e.g., last 3 years), the system computes and returns a list of lessons (cours) sorted by how many questions appeared on them during those years.  
  - Backend supports query to aggregate question counts grouped by course name + filter by year range.  
- **Links to External Resources**: provide links to drives (past years), Telegram channels, solution notebooks.  
  - Backend model/table for `external_links`: id, title, url, category (drive, telegram, cahier), year, module.  
- **Study With Me / Focus Timer**: the concept of students opening “study mode” similar to forest-apps.  
  - Backend support: record study sessions: user_id, device, started_at, stopped_at, duration. Allow endpoints to fetch daily/weekly study time.  
- **Device Limit Enforcement**: existing from authentication/device management.  
- **Payment Options Localised**: backend should support offline card verification and receipt submission (via email or upload).  
  - Model for `payment_receipts`: id, user_id, amount, method, receipt_image_url, status (pending/approved), created_at.

---

## 6. Admin Dashboard & Analytics

- Dashboard endpoint (Admin/Owner) summarising:  
  - User stats: total users, paid/unpaid breakdown, counts by role (owner, admin, manager, student)  
  - Question stats: total questions, total answers, average answers per question  
  - Activation key stats: total keys, used vs unused  
  - Course stats: list of courses + count of questions  
  - Speciality stats: list of specialities + count  
  - Year stats: list of exam years + count of questions  
- Activation key endpoints:  
  - Create new activation keys (Admin/Owner)  
  - List activation keys with filters (skip, limit, is_used)  
  - Stats for activation keys (total, used, unused)  
- User management:  
  - List users (skip, limit) with filters user_type, is_paid (Manager/Admin)  
  - Update user payment status (Manager/Admin)  
  - Update user role (Admin/Owner)  
  - Get detailed user info for user (Manager/Admin)  
  - Delete user (Admin only)  
- Protect Owner account: cannot be deleted or have its role changed by anyone else.

---

## 7. Security & Infrastructure

- JWT-based authentication using configurable `SECRET_KEY`, `ALGORITHM`, `ACCESS_TOKEN_EXPIRE_MINUTES`.  
- Password hashing with bcrypt (via passlib).  
- Role-based route protection (RBAC).  
- Payment access enforcement for question retrieval.  
- Device session limit per user (max 2).  
- Input validation with Pydantic models.  
- Use of ORM (SQLAlchemy) to prevent SQL-injection.  
- CORS middleware and configurable allowed origins.  
- Database migrations with Alembic.  
- Environment variables for configuration (database URL, secret key, etc.).  
- Rate-limiting or device constraints via device sessions.  
- Unique constraints on email, username.  
- Hashing of sensitive information; no storing of plaintext passwords.

---

## 8. DevOps, Scripts & Maintenance

- Scripts included:  
  - `create_owner.py`: interactive script to create the initial owner account.  
  - `seed_data.py`: seed sample users (admin, manager, students) and sample questions for testing.  
  - `import_questions.py`: import bulk questions from JSON file.  
- DB migrations: using Alembic. Support for `alembic revision --autogenerate`, `alembic upgrade head`, `alembic downgrade -1`.  
- Logging: configured with timestamp, logger name, log level; console logging by default.  
- Health-check endpoint (e.g., `/health`) for service monitoring.  
- Swagger UI (`/docs`) and ReDoc (`/redoc`) for API documentation.  
- Performance tips: pagination (skip/limit), filtering, ensure DB indexes, connection pooling, optional caching for frequently accessed data.

---

## 9. Multi-platform Support (Web + Mobile)

- The backend API supports both web and mobile front-ends (React + Expo/React Native) via standard REST endpoints.  
- Device fingerprinting and device session management support mobile + tablet + desktop usage.  
- External links opening outside of app (e.g., when user clicks drive/telegram link, it opens externally).  
- Support for image upload for questions/answers (via `python-multipart` file upload).  
- Mobile-friendly endpoints for study timer/tracking.

---

## 10. Localisation & Market Adaptation (Algerian Market)

- Arabic language support (UI side) + French/English fallback.  
- Payment methods specific to Algerian market (e.g., Baridi Mob).  
- External resources relevant to Algerian students: past-year MCQs, drives, Telegram channels, “Cahiers de solutions”.  
- Study mode (“Study With Me”) geared toward local student behaviors and motivational features.  
- Analytics/features showing “lessons most frequently asked in exams in past X years” → helps students focus revision according to local exam trends.

---

## 11. Roadmap / Upcoming Features

- Live synchronization of study-sessions across devices.  
- Real-time group “study room” feature (chat/video) for “Study With Me”.  
- Push notifications/reminders for timed study sessions.  
- Adaptive learning algorithm: track student's weak areas and suggest targeted questions.  
- Offline mode (mobile) with local caching of some questions.  
- Gamification: badges, leaderboards, study streaks.  
- Analytics dashboard for students (time studied per day/week, accuracy trend).  
- Payment gateway integration (online payment) in addition to offline card & receipt upload.

---

## Summary

This features document encapsulates **all major functionalities** planned for the MCQ Study App backend and its connected web/mobile front-ends, including core question management, user and role management, subscription/activation system, device session enforcement, rich student-centric analytics and market-tailored features for Algerian context.

You can use this file to drive your product requirements document (PRD) or to serve as a living “features catalogue” within your repository.

---

_End of FEATURES.md_
